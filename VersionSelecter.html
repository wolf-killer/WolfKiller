<!DOCTYPE html> 
<html> 
<head> 
  <title>狼人殺</title> 
  <meta charset="utf-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
  <meta http-equiv="cache-control" content="no-cache" /> 
  <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1, user-scalable=no">
  <link rel="icon" type="image/x-icon" href="./image/WebIcon.png">
  <link rel="stylesheet" type="text/css" href="./Layout.css"/>
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Allerta+Stencil">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.0/font/bootstrap-icons.css">
  <!--icon list: https://icons.getbootstrap.com/ -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> 
  <script src="./GeneralFunction.js"></script>
  <script src="./Version.js"></script>
  <script src="./Definition.js"></script>
  <script src="./Translate.js"></script>
  <!--<script src="./Function.js"></script>-->
</head> 
<body class="w3-allerta" style="overflow-x: hidden; overflow-y: hidden;"> 
	<div id="FixScreen" class="w3-display-container"> 
		<div id="versionSelecter" class="PopupInfo w3-container w3-center w3-round-xxlarge" style="">
			<div class="w3-row w3-margin-top" style=""> 
				<div class="w3-container s12 m12 l12 w3-col w3-center w3-col-middle w3-pale-blue w3-leftbar w3-rightbar w3-border-blue"> 
					好人陣營<i class="bi bi-info-circle" style="margin-left: 2px;"></i>
				</div>
				<div class="actorCard w3-container s3 m3 l2 w3-col w3-center w3-col-middle" style="padding: 0px;">
					<img id="actorVillager" class="actorImg" src="./image/actor/Villager.png" name="Villager">
					<p id="actorVillagerCount" name="actorVillagerCount" class="actorCount w3-border w3-round-xxlarge">0</p>
				</div>
				<div class="actorCard w3-container s3 m3 l2 w3-col w3-center w3-col-middle" style="padding: 0px;">
					<img id="actorSeer" class="actorImg" src="./image/actor/Seer.png" name="Seer">
					<p id="actorSeerCount" name="actorSeerCount" class="actorCount w3-border w3-round-xxlarge">0</p>
				</div>
				<div class="actorCard w3-container s3 m3 l2 w3-col w3-center w3-col-middle" style="padding: 0px;">
					<img id="actorWitch" class="actorImg" src="./image/actor/Witch.png" name="Witch">
					<p id="actorWitchCount" name="actorWitchCount" class="actorCount w3-border w3-round-xxlarge">0</p>
				</div>
				<div class="actorCard w3-container s3 m3 l2 w3-col w3-center w3-col-middle" style="padding: 0px;">
					<img id="actorHunter" class="actorImg" src="./image/actor/Hunter.png" name="Hunter">
					<p id="actorHunterCount" name="actorHunterCount" class="actorCount w3-border w3-round-xxlarge">0</p>
				</div>
				<div class="actorCard w3-container s3 m3 l2 w3-col w3-center w3-col-middle" style="padding: 0px;">
					<img id="actorKnight" class="actorImg" src="./image/actor/Knight.png" name="Knight">
					<p id="actorKnightCount" name="actorKnightCount" class="actorCount w3-border w3-round-xxlarge">0</p>
				</div>
				<div class="actorCard w3-container s3 m3 l2 w3-col w3-center w3-col-middle" style="padding: 0px;">
					<img id="actorGuard" class="actorImg" src="./image/actor/Guard.png" name="Guard">
					<p id="actorGuardCount" name="actorGuardCount" class="actorCount w3-border w3-round-xxlarge">0</p>
				</div>
				<div class="actorCard w3-container s3 m3 l2 w3-col w3-center w3-col-middle" style="padding: 0px;">
					<img id="actorBear" class="actorImg" src="./image/actor/Bear.png" name="Bear">
					<p id="actorBearCount" name="actorBearCount" class="actorCount w3-border w3-round-xxlarge">0</p>
				</div>
				<div class="actorCard w3-container s3 m3 l2 w3-col w3-center w3-col-middle" style="padding: 0px;">
					<img id="actorIdiot" class="actorImg" src="./image/actor/Idiot.png" name="Idiot">
					<p id="actorIdiotCount" name="actorIdiotCount" class="actorCount w3-border w3-round-xxlarge">0</p>
				</div>
				<div class="w3-container s12 m12 l12 w3-col w3-center w3-col-middle w3-pale-blue w3-leftbar w3-rightbar w3-border-blue">
						狼人陣營<i class="bi bi-info-circle" style="margin-left: 2px;"></i>
				</div>
				<div class="actorCard w3-container s3 m3 l2 w3-col w3-center w3-col-middle" style="padding: 0px;">
					<img id="actorWolf" class="actorImg" src="./image/actor/Wolf.png" name="Wolf">
					<p id="actorWolfCount" name="actorWolfCount" class="actorCount w3-border w3-round-xxlarge">0</p>
				</div>
				<div class="actorCard w3-container s3 m3 l2 w3-col w3-center w3-col-middle" style="padding: 0px;">
					<img id="actorWolfKing" class="actorImg" src="./image/actor/WolfKing.png" name="WolfKing"><br/>
					<p id="actorWolfKingCount" name="actorWolfKingCount" class="actorCount w3-border w3-round-xxlarge">0</p>
				</div>
				<div class="actorCard w3-container s3 m3 l2 w3-col w3-center w3-col-middle" style="padding: 0px;">
					<img id="actorSecretWolf" class="actorImg" src="./image/actor/SecretWolf.png" name="SecretWolf"><br/>
					<p id="actorSecretWolfCount" name="actorSecretWolfCount" class="actorCount w3-border w3-round-xxlarge">0</p>
				</div>
				<div class="actorCard w3-container s3 m3 l2 w3-col w3-center w3-col-middle" style="padding: 0px;">
					<img id="actorGhostWolf" class="actorImg" src="./image/actor/GhostWolf.png" name="GhostWolf">
					<p id="actorGhostWolfCount" name="actorGhostWolfCount" class="actorCount w3-border w3-round-xxlarge">0</p>
				</div>
				<!--
				<div class="actorCard w3-container s3 m3 l2 w3-col w3-center w3-col-middle" style="padding: 0px;">
					<img id="actorPrettyWolf" class="actorImg" src="./image/actor/PrettyWolf.png" name="PrettyWolf">
					<p id="actorPrettyWolfCount" name="actorPrettyWolfCount" class="actorCount w3-border w3-round-xxlarge">0</p>
				</div>
				<div class="actorCard w3-container s3 m3 l2 w3-col w3-center w3-col-middle" style="padding: 0px;">
					<img id="actorStoneWolf" class="actorImg" src="./image/actor/StoneWolf.png" name="StoneWolf"><br/>
					<p id="actorStoneWolfCount" name="actorStoneWolfCount" class="actorCount w3-border w3-round-xxlarge">0</p>
				</div>
				<div class="actorCard w3-container s3 m3 l2 w3-col w3-center w3-col-middle" style="padding: 0px;">
					<img id="actorBloodWolf" class="actorImg" src="./image/actor/BloodWolf.png" name="BloodWolf"><br/>
					<p id="actorBloodWolfCount" name="actorBloodWolfCount" class="actorCount w3-border w3-round-xxlarge">0</p>
				</div>
				<div class="actorCard w3-container s3 m3 l2 w3-col w3-center w3-col-middle" style="padding: 0px;">
					<img id="actorWhiteWolf" class="actorImg" src="./image/actor/WhiteWolf.png" name="WhiteWolf"><br/>
					<p id="actorWhiteWolfCount" name="actorWhiteWolfCount" class="actorCount w3-border w3-round-xxlarge">0</p>
				</div>
				-->
			</div>
			<br/>
			<div id="defaultVersion" class="w3-row" style="width:100%"> 
				<div class="s3 m3 l2 w3-col w3-left-align w3-col-middle" onclick="selectVersion(0)">
						預設組合：
				</div>
				<div class="s3 m3 l2 w3-col w3-center w3-col-middle" onclick="selectVersion(6)">
					<button class="wolf-btn w3-btn w3-block w3-round-large">
						<i class="bi bi-person"></i>x 6
					</button>
				</div>
				<div class="s3 m3 l2 w3-col w3-center w3-col-middle" onclick="selectVersion(7)">
					<button class="wolf-btn w3-btn w3-block w3-round-large">
						<i class="bi bi-person"></i>x 7
					</button>
				</div>
				<div class="s3 m3 l2 w3-col w3-center w3-col-middle" onclick="selectVersion(8)">
					<button class="wolf-btn w3-btn w3-block w3-round-large">
						<i class="bi bi-person"></i>x 8
					</button>
				</div>
				<div class="s3 m3 l2 w3-col w3-center w3-col-middle" onclick="selectVersion(9)">
					<button class="wolf-btn w3-btn w3-block w3-round-large">
						<i class="bi bi-person"></i>x 9
					</button>
				</div>
				<div class="s3 m3 l2 w3-col w3-center w3-col-middle" onclick="selectVersion(10)">
					<button class="wolf-btn w3-btn w3-block w3-round-large">
						<i class="bi bi-person"></i>x 10
					</button>
				</div>
				<div class="s3 m3 l2 w3-col w3-center w3-col-middle" onclick="selectVersion(11)">
					<button class="wolf-btn w3-btn w3-block w3-round-large">
						<i class="bi bi-person"></i>x 11
					</button>
				</div>
				<div class="s3 m3 l2 w3-col w3-center w3-col-middle" onclick="selectVersion(12)">
					<button class="wolf-btn w3-btn w3-block w3-round-large">
						<i class="bi bi-person"></i>x 12
					</button>
				</div>
			</div>
			<div id="otherRule" class="w3-row w3-margin-top" style=""> 
				<div class="w3-container s12 m12 l12 w3-col w3-center w3-col-middle w3-pale-blue w3-leftbar w3-rightbar w3-border-blue"> 
					勝利條件
				</div>
				<div class="w3-container s6 m6 l6 w3-col w3-center w3-col-middle" style="padding: 0px;">
					<input type="radio" id="gnv" name="versionMode" value="gnv">
					屠城 
				</div>
				<div class="w3-container s6 m6 l6 w3-col w3-center w3-col-middle" style="padding: 0px;">
					<input type="radio" id="gonly" name="versionMode" value="gonly" checked>
					屠邊
				</div>
				<!--<div class="w3-container s12 m12 l12 w3-col w3-center w3-col-middle w3-pale-blue w3-leftbar w3-rightbar w3-border-blue"> 
					其他規則
				</div>
				<div class="w3-container s6 m6 l6 w3-col w3-center w3-col-middle" style="padding: 0px;">
					<input type="radio" id="tableAlign" name="alignment" value="tableAlign">
					表格形式
					<i class="bi bi-grid-3x3"></i>
				</div>
				<div class="w3-container s6 m6 l6 w3-col w3-center w3-col-middle" style="padding: 0px;">
					<input type="radio" id="lrAlign" name="alignment" value="lrAlign" checked>
					左右分隔
					<i class="bi bi-distribute-horizontal"></i>
				</div>-->
				<div class="w3-container s12 m12 l12 w3-col w3-center w3-col-middle w3-pale-blue w3-leftbar w3-rightbar w3-border-blue"> 
					畫面形式
				</div>
				<div class="w3-container s6 m6 l6 w3-col w3-center w3-col-middle" style="padding: 0px;">
					<input type="radio" id="tableAlign" name="alignment" value="tableAlign">
					表格形式
					<i class="bi bi-grid-3x3"></i>
				</div>
				<div class="w3-container s6 m6 l6 w3-col w3-center w3-col-middle" style="padding: 0px;">
					<input type="radio" id="lrAlign" name="alignment" value="lrAlign" checked>
					左右分隔
					<i class="bi bi-distribute-horizontal"></i>
				</div>
			</div>
			<div class="w3-container w3-center w3-col-middle">
				<button onclick="submitVersion()" style="width:50%">
					Save
					(<span id="submitTotalPlayer" class="">0</span>)
				</button>
			</div>
		</div>
	</div>
</body> 
<script>
var setWidth = document.documentElement.scrollWidth;
var setHeight = document.documentElement.scrollHeight;
var wh = 0;
var landscape = false;

var submitTotalPlayer = 0;
var totalActorArray = [];
var godArray = []; 
var godChinArray = [];
var villagerArray = []; 
var villagerChinArray = [];
var wolfArray = []; 
var wolfChinArray = []; 
var versionMode;
var alignment;

$(document).ready(function(){
	setWidth = getUrlParameter('setWidth')?
						getUrlParameter('setWidth'):
						document.documentElement.scrollWidth;
	setHeight = getUrlParameter('setHeight')?
						getUrlParameter('setHeight'):
						document.documentElement.scrollHeight;
	$("#FixScreen").css("height", setHeight);
	$("#FixScreen").css("width", setWidth);
	wh = setWidth / setHeight;
	if(wh>0.7){
		landscape = true;
		$('input:radio[name=alignment]').filter('[value=tableAlign]').prop('checked', true);
	}
	getVersionSelecter();
}); 

$(document).on("click", '.actorImg', function(temp){
	var controlActor = temp.currentTarget.name;
	var controlActorCount = parseInt($("#actor"+controlActor+"Count").text());
	if (controlActorCount == 0){
		submitTotalPlayer++;
		$("#actor"+controlActor+"Count").text(controlActorCount+1);
		$("#actor"+controlActor+"Count").addClass("w3-pale-red");
		$("#actor"+controlActor).addClass("w3-border-red");
	}else if (controlActorCount == 1){
		if(controlActor == "Villager" || controlActor == "Wolf"){
			submitTotalPlayer++;
			$("#actor"+controlActor+"Count").text(controlActorCount+1);
			$("#actor"+controlActor+"Count").addClass("w3-pale-red");
		}else{
			submitTotalPlayer--;
			$("#actor"+controlActor+"Count").text(controlActorCount-1);
			$("#actor"+controlActor+"Count").removeClass("w3-pale-red");
			$("#actor"+controlActor).removeClass("w3-border-red");
		}
	}else if (controlActorCount == 2){
		if(controlActor == "Villager" || controlActor == "Wolf"){
			submitTotalPlayer++;
			$("#actor"+controlActor+"Count").text(controlActorCount+1);
		}
	}else if (controlActorCount == 3){
		if(controlActor == "Villager"){
			submitTotalPlayer++;
			$("#actor"+controlActor+"Count").text(controlActorCount+1);
		}else if (controlActor == "Wolf"){
			submitTotalPlayer = submitTotalPlayer-controlActorCount;
			$("#actor"+controlActor+"Count").text(0);
			$("#actor"+controlActor).removeClass("w3-border-red");
			$("#actor"+controlActor+"Count").removeClass("w3-pale-red");
		}
	}else if (controlActorCount > 3){
		if(controlActor == "Villager"){
			submitTotalPlayer = submitTotalPlayer-controlActorCount;
			$("#actor"+controlActor+"Count").text(0);
			$("#actor"+controlActor).removeClass("w3-border-red");
			$("#actor"+controlActor+"Count").removeClass("w3-pale-red");
		}
	}
	$("#submitTotalPlayer").text(submitTotalPlayer);
	if(submitTotalPlayer > 12){
		$('input:radio[name=alignment]').filter('[value=tableAlign]').prop('checked', true);
	}
});
function selectVersion(noOfPlayer){
	resetVersion();
	$("#submitTotalPlayer").text(noOfPlayer);
	if(noOfPlayer == 0){
		return;
	}
	var tempArray;
	submitTotalPlayer = noOfPlayer;
	switch(noOfPlayer){
		case 6:
			$('input:radio[name=versionMode]').filter('[value=gnv]').prop('checked', true);
			tempArray = array6;
			break;
		case 7:
			tempArray = array7;
			break;
		case 8:
			tempArray = array8;
			break;
		case 9:
			tempArray = array9;
			break;
		case 10: 
			tempArray = array10;
			break;
		case 11: 
			tempArray = array11;
			break;
		case 12: 
			tempArray = array12;
			break;
		default:
			console.log(noOfPlayer);
			break;
	}

	for(var i=0; i<tempArray.length; i++){
		var controlActor = tempArray[i];
		var lastChar = controlActor.substring(controlActor.length - 1);
		if(lastChar == 1 || lastChar == 2 || lastChar == 3){
			controlActor = controlActor.substring(0, controlActor.length-1);
		}
		var controlActorCount = parseInt($("#actor"+controlActor+"Count").text());
		$("#actor"+controlActor+"Count").text(controlActorCount+1);
		$("#actor"+controlActor+"Count").addClass("w3-pale-red");
		$("#actor"+controlActor).addClass("w3-border-red");
	}
}
function submitVersion(){
	var prefix = "actor";
	var postfix = "Count";
	for(var i=0; i<$(".actorCount").length; i++){
		var tempActor = $(".actorCount")[i].id;
		var tempActorCount = $(".actorCount")[i].innerText;
		var prefixPosition = tempActor.indexOf(prefix);
		var postfixPosition = tempActor.indexOf(postfix);
		tempActor = tempActor.slice(prefixPosition+prefix.length, postfixPosition)
		if(tempActor.length > 0 && tempActorCount > 0){
			if(allGod.includes(tempActor)){
				for(var j=0; j<tempActorCount; j++){
					totalActorArray.push(tempActor+(j>0?j:"")); 
					godArray.push(tempActor+(j>0?j:"")); 
					godChinArray.push(translate(tempActor)+(j>0?"["+translate(j)+"]":""));
				}	
			}else if(allVillager.includes(tempActor)){
				for(var j=0; j<tempActorCount; j++){
					totalActorArray.push(tempActor+(j>0?j:"")); 
					villagerArray.push(tempActor+(j>0?j:""));
					villagerChinArray.push(translate(tempActor)+(j>0?"["+translate(j)+"]":""));
				}					
			}else if(allWolf.includes(tempActor)){
				for(var j=0; j<tempActorCount; j++){
					totalActorArray.push(tempActor+(j>0?j:"")); 
					wolfArray.push(tempActor+(j>0?j:"")); 
					wolfChinArray.push(translate(tempActor)+(j>0?"["+translate(j)+"]":"")); 
				}
			}
		}
	}
	if(!(wolfArray.length > 0 && villagerArray.length > 0 && godArray.length > 0) || totalActorArray.length < 6){
		resetVersion();
		alert("最少六名玩家\r\n並且每個陣營最少要有一名玩家");	
		return;
	}
	versionMode = $("input:radio[name=versionMode]:checked").val();
	/*versionLog += "版本：<br/>玩家："+translate(submitTotalPlayer)+"人<br/>屠邊："+translate(versionMode)+"<br/>角色分佈：";
	versionLog += "<table class='w3-topbar w3-bottombar w3-border-blue w3-pale-blue' style='width:100%'>";
	versionLog += "<tr><td style='width:40px;'>神職</td><td>"+godChinArray.toString()+"</td></tr>";
	versionLog += "<tr><td>平民</td><td>"+villagerChinArray.toString()+"</td></tr>";
	versionLog += "<tr><td>狼人</td><td>"+wolfChinArray.toString()+"</td></tr>";
	versionLog += "</table><br/>";
	$("#log").html(versionLog);*/
	//closePopUp();
	//startNewGame();
	//showVersion();
	goPage("WolfKiller");
}
function resetVersion(){
	submitTotalPlayer = 0;
	$(".actorCount").text("0");
	$(".actorImg").removeClass("w3-border-red");
	$(".actorCount").removeClass("w3-pale-red");
	totalActorArray = [];
	godArray = [];
	villagerArray = [];
	wolfArray = [];
	$('input:radio[name=versionMode]').filter('[value=gonly]').prop('checked', true);
	versionMode = "";
}


function getVersionSelecter(){

}

function goPage(pageName){
	path = 	"./WolfKiller.html";
	path += "?setWidth="+setWidth;
	path += "&setHeight="+setHeight;
	
	window.location.href = path;
}
</script>
</html> 


