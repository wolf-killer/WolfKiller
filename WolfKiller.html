<!DOCTYPE html> 
<html> 
<head> 
  <title>狼人殺</title> 
  <meta charset="utf-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
  <meta http-equiv="cache-control" content="no-cache" /> 
  <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1, user-scalable=no">
  <link rel="icon" type="image/x-icon" href="./image/WebIcon.png">
  <link rel="stylesheet" type="text/css" href="./Layout.css"/>
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/earlyaccess/notosanstc.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/earlyaccess/cwtexyen.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.0/font/bootstrap-icons.css">
  <!--icon list: https://icons.getbootstrap.com/ -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> 
  <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
  <script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
  <script src="./long-press-event.min.js"></script>
  <script src="./GeneralFunction.js"></script>
  <script src="./Version.js"></script>
  <script src="./Definition.js"></script>
  <script src="./Translate.js"></script>
  <!--<script src="./Function.js"></script>-->
</head>  
<body oncontextmenu="return false;"> 
	<div id="FixScreen" class="w3-display-container"> 
		<div id="menuBar" class="wolf-bar w3-bar w3-white w3-display-topmiddle w3-display-hover"> 
			<i class="wolf-bar-item bi bi-question-diamond" onclick="showInfo()"></i>
			<i class="wolf-bar-item bi bi-pencil-square" onclick="showLog()"></i>
			<i class="wolf-bar-item bi bi-recycle" onclick="location.reload()"></i>
			<i class="wolf-bar-item bi bi-sun" onclick="updateAction()"></i>
			<i class="wolf-bar-item bi bi-moon" onclick="updateAction('nightTime')"></i>
			<i class="wolf-bar-item bi bi-music-note-beamed" onclick="playSound('testAudio')"></i>
			<i class="wolf-bar-item bi bi-person-plus" onclick="versionSelect()"></i>
		</div> 
		<div id="menuBar2" class="wolf-bar w3-bar w3-white w3-display-bottommiddle w3-display-hover"> 
			<i class="wolf-bar-item bi bi-question-diamond" onclick="showInfo()"></i>
			<i class="wolf-bar-item bi bi-pencil-square" onclick="showLog()"></i>
			<i class="wolf-bar-item bi bi-recycle" onclick="location.reload()"></i>
			<i class="wolf-bar-item bi bi-sun" onclick="updateAction()"></i>
			<i class="wolf-bar-item bi bi-moon" onclick="updateAction('nightTime')"></i>
			<i class="wolf-bar-item bi bi-music-note-beamed" onclick="playSound('testAudio')"></i>
			<i class="wolf-bar-item bi bi-person-plus" onclick="versionSelect()"></i>
		</div> 
		<div id="seatingPlan" class="">		
		</div>
	</div>
</body> 
<script>
var totalActorArray = GetUrlParameter('totalActorArray')? GetUrlParameter('totalActorArray').split(","): [];
var godArray = GetUrlParameter('godArray')? GetUrlParameter('godArray').split(","): [];
var godChinArray = GetUrlParameter('godChinArray')? GetUrlParameter('godChinArray').split(","): [];
var villagerArray = GetUrlParameter('villagerArray')? GetUrlParameter('villagerArray').split(","): [];
var villagerChinArray = GetUrlParameter('villagerChinArray')? GetUrlParameter('villagerChinArray').split(","): [];
var wolfArray = GetUrlParameter('wolfArray')? GetUrlParameter('wolfArray').split(","): [];
var wolfChinArray = GetUrlParameter('wolfChinArray')? GetUrlParameter('wolfChinArray').split(","): [];
var versionMode = GetUrlParameter('versionMode')? GetUrlParameter('versionMode'): null;
var windowMode = GetUrlParameter('windowMode')? GetUrlParameter('windowMode'): null;

var totalPlayer = 0;
var player = [null]; 
var alivePlayer = [null];
var godAlivePlayer = []; 
var villagerAlivePlayer = []; 
var wolfAlivePlayer = []; 
var action;

$(window).on("load", function(){
	if(totalActorArray.length < 6){
		ShowAlert("alert", "錯誤", "重啟遊戲");
		GoPage("VersionSelecter", {});
		return;
	}
	SetWindow();
	gameInit();
}); 
function gameInit(){
	console.log(totalActorArray);
	totalPlayer = totalActorArray.length;
	player = [null]; 
	
	for(var i=totalPlayer; i>0; i--){
		//var no = Math.floor(Math.random() * (i - 0)) + 0; 
		var no = Math.floor(GetRandom() * (i - 0)) + 0;
		player.push(totalActorArray[no]); 
		alivePlayer.push(totalActorArray[no]); 
		totalActorArray.splice(no,1); 
	} 
	console.log(player); 
	godAlivePlayer = godArray;
	villagerAlivePlayer = villagerArray;
	wolfAlivePlayer = wolfArray;
	setPlayerSeat();
	
	/*
	action = "confirmRole"; 
	//$("#playConfirmRoles").click();
	confirmRoles.play();
	confirmPlayer ++;
	$("#playerImg"+confirmPlayer).addClass("confirming");
	$(".info").show();
	$(".info").html("確認身份"+
					"<i onclick=\"updateAction('confirmRole')\" class=\"bi bi-person-bounding-box\" style=\"margin-left:20px;\"></i>");	
	log += "<table class='dayLog w3-pale-blue'>";
	*/
}
function setPlayerSeat(){
	$("#seatingPlan").html("");
	var html="";
	console.log("windowMode:" + windowMode);
	
	if(windowMode == "tableAlign"){
			//show as table
		html += 
			"	<div id=\"for-"+totalPlayer+"-player\" class=\"w3-container\" style=\"width:100%; height:100%\">" +
			"		<div class=\"w3-row\" style=\"width:100%\"> ";
		for(var loop=1; loop<=totalPlayer; loop++){
			html += 
			"			<div class=\"w3-container s4 m3 l2 w3-col w3-center w3-col-middle\" style=\"\"> " +
			"				<div " +
			"					id=\"playerCard"+loop+"\" " +
			"					name=\""+loop+"\"" +
			"					class=\"playerCard playerButton alivePlayer \"> " +
			"					<img id=\"playerImg"+loop+"\" class=\"playerImg\" src=\"./image/actor/Player.png\" style=\"\"> " +
			"					<img id=\"diedImg"+loop+"\" class=\"diedImg\" src=\"./image/Died.png\" style=\"\"> " +
			"					<img id=\"killImg"+loop+"\" class=\"killImg\" src=\"./image/Kill.png\" style=\"\"> " +
			"				</div> " +
			"				<button " +
			"					id=\"playerButton"+loop+"\" " +
			"					name=\""+loop+"\"					" +
			"					class=\"playerButton alivePlayer \"" +
			"					style=\"width:100%;\"> " +
			"					"+translate(loop)+"號玩家" +
			"				</button> " +
			"			</div>" ;
		}
		html += 
			"		</div>" +
			"	</div>";
	}else if(windowMode == "lrAlign"){	
			//show only left-right
		var y = totalPlayer;
		var x = 1;
		html += 
			"	<table id=\"for-"+totalPlayer+"-player\" class=\"seatingTable\" style=\"\">";
		for(var x=1; x<y; x++){
			html += 
			"		<tr> " + 
			"			<td class=\"wolf-td1\" style=\"transform:rotate(90deg);\"> " +
			"				<div " +
			"					id=\"playerCard"+x+"\" " +
			"					name=\""+x+"\"" +
			"					class=\"playerCard playerButton alivePlayer\"> " +
			"					<img id=\"playerImg"+x+"\" class=\"playerImg\" src=\"./image/actor/Player.png\" style=\"\"> " +
			"					<img id=\"diedImg"+x+"\" class=\"diedImg\" src=\"./image/Died.png\" style=\"\"> " +
			"					<img id=\"killImg"+x+"\" class=\"killImg\" src=\"./image/Kill.png\" style=\"\"> " +
			"				</div> " +
			"				<button " +
			"					id=\"playerButton"+x+"\" " +
			"					name=\""+x+"\" " +
			"					class=\"playerButton alivePlayer\"" +
			"					style=\"width:100%;\"> " +
			"					"+translate(x)+"號" +
			"				</button> " +
			"			</td>" +
			"			<td class=\"wolf-td2\" style=\"\"> " +
			"			</td>" +
			"			<td class=\"wolf-td3\" style=\"transform:rotate(-90deg);\"> " +
			"				<div " +
			"					id=\"playerCard"+y+"\" " +
			"					name=\""+y+"\"" +
			"					class=\"playerCard playerButton alivePlayer\"> " +
			"					<img id=\"playerImg"+y+"\" class=\"playerImg\" src=\"./image/actor/Player.png\" style=\"\"> " +
			"					<img id=\"diedImg"+y+"\" class=\"diedImg\" src=\"./image/Died.png\" style=\"\"> " +
			"					<img id=\"killImg"+y+"\" class=\"killImg\" src=\"./image/Kill.png\" style=\"\"> " +
			"				</div> " +
			"				<button " +
			"					id=\"playerButton"+y+"\" " +
			"					name=\""+y+"\" " +
			"					class=\"playerButton alivePlayer\" " +
			"					style=\"width:100%;\"> " +
			"					"+translate(y)+"號" +
			"				</button> " +
			"			</td>" + 
			"		</tr>";
			y=y-1;
		}
		if(totalPlayer%2>0){
			html += 
			"		<tr> " + 
			"			<td class=\"wolf-td1\" style=\"transform:rotate(90deg);\"> " +
			"				<div " +
			"					id=\"playerCard"+x+"\" " +
			"					name=\""+x+"\"" +
			"					class=\"playerCard playerButton alivePlayer\"> " +
			"					<img id=\"playerImg"+x+"\" class=\"playerImg\" src=\"./image/actor/Player.png\" style=\"\"> " +
			"					<img id=\"diedImg"+x+"\" class=\"diedImg\" src=\"./image/Died.png\" style=\"\"> " +
			"					<img id=\"killImg"+x+"\" class=\"killImg\" src=\"./image/Kill.png\" style=\"\"> " +
			"				</div> " +
			"				<button " +
			"					id=\"playerButton"+x+"\" " +
			"					name=\""+x+"\" " +
			"					class=\"playerButton alivePlayer\"" +
			"					style=\"width:100%;\"> " +
			"					"+translate(x)+"號" +
			"				</button> " +
			"			</td>" +
			"			<td class=\"wolf-td2\" style=\"\"> " +
			"			</td>" +
			"			<td class=\"wolf-td3\" style=\"\"> " +
			"			</td>" + 
			"		</tr>";
		}
		html += 
			"	</table>";
	}
	$("#seatingPlan").html(html);
	var stHeight = $(".seatingTable").height(); 
	var stWidth = $(".seatingTable").width(); 
	var scale = (stWidth/stHeight)*wh;
	if(scale > 0.5)
		$(".seatingTable").css('transform', 'scale(' + (stWidth/stHeight)*wh + ')');
	/*
	if(action == "confirmRole"){
		$(".info").html("確認身份"+
						"<i onclick=\"updateAction('confirmRole')\" class=\"bi bi-person-bounding-box\" style=\"margin-left:20px;\"></i>");	
		$("#playerImg"+confirmPlayer).addClass("confirming");
	}*/
}
</script>
</html> 